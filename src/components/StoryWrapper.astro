---
import StoryGrid from '@components/StoryGrid.astro'
import NewGrid from '@components/grid/NewGrid.astro'
import StoryList from '@components/StoryList.astro'
import TagsHeader from '@components/tags/TagsHeader.astro'
import TagsFooter from '@components/tags/TagsFooter.astro'

const { stories, tags, view } = Astro.props
---

{
	!view && (
		<>
			{/* Story grid view */}
			<div class={`stories-container--grid grid--shared`} id='stories-container--grid'>
				<NewGrid stories={stories} />
			</div>

			{/* Story list view */}
			<div class={`stories-container--list mt-[8rem] lg:mt-20 pt-0 sm:py-12 list--shared`} id='stories-container--list bg-black'>
				<div id='city' class='top-0 left-0 fixed w-full h-full -z-1' />
				<StoryList stories={stories} />
			</div>
		</>
	)
}

{
	view === 'grid' && (
		<>
			{/* Story grid view */}
			<div class={`stories-container--grid`} id='stories-container--grid'>
				<NewGrid stories={stories} />
			</div>
		</>
	)
}

{
	view === 'list' && (
		<>
			{/* Story list view */}
			<div class={`stories-container--list mt-[8rem] lg:mt-20 pt-0 sm:py-12`} id='stories-container--list bg-black'>
				<div id='city' class='top-0 left-0 fixed w-full h-full -z-1' />
				<StoryList stories={stories} />
			</div>
		</>
	)
}

{
	view === 'tags' && (
		<>
			{/* Story list view */}
			<div class={`stories-container--tags mt-16 sm:mt-20`} id='stories-container--tags'>
				<div id='city' class='top-0 left-0 fixed w-full h-full -z-1' />
				<div class='w-full text-center'>
					<slot name='top' />
				</div>
				<TagsHeader tags={tags} />
				<StoryList stories={stories} id='tags' />
				<TagsFooter tags={tags} />
			</div>
		</>
	)
}

<style is:global>
	header {
		position: fixed;
		z-index: 9999 !important;
	}

	.stories-container--grid {
		position: fixed;
		top: 0;
		left: 0;
		width: 100%;
		height: 100vh;
		z-index: 5555;
		overflow: hidden;
	}
</style>

<script define:vars={{ view }}>
	document.addEventListener('astro:page-load', () => {
		localStorage.setItem('currentView', view)
	})
</script>
