---
// Create pages for both languages
export function getStaticPaths() {
	// Return a list of possible value for lang
	return [{ params: { lang: 'en' } }, { params: { lang: 'ar' } }]
}

import Layout from '../layouts/Layout.astro'
import StoryWrapper from '../components/StoryWrapper.astro'
import SEO from '../components/SEO.astro'

import stories from '../data/all_stories.json'

function shuffleArray(array) {
	for (let i = array.length - 1; i > 0; i--) {
		// Generate a random index
		const j = Math.floor(Math.random() * (i + 1))

		// Swap elements at indices i and j
		;[array[i], array[j]] = [array[j], array[i]]
	}
}
// Todo: Can this be done "once" per session perhaps? // Testing pipeline
shuffleArray(stories)

let { lang } = Astro.params
---

<Layout dark title='The Yemen Listening Project' header={true} filterButtons={true} languageButtons={{ ar: '/ar', en: '/en' }} switchViewButtons={true}>
	<SEO
		slot='seo'
		title={`The Yemen Listening Project`}
		description={lang === 'ar' ? '.حيثُ يتحدّث اليَمنيّون ويستمع العالمُ إليهم' : 'Where Yemenis talk, and the world listens.'}
	/>
	<div class='fixed top-0 left-0 w-screen h-screen -z-1 pointer-events-none' id='city'></div>
	<StoryWrapper stories={stories} />
</Layout>

<style>
	#city {
		z-index: -1;
		background-image: url('https://assets.thenewhumanitarian.org/s3fs-public/styles/responsive_large/public/2023-06/night-sky-overlay_0.png.webp');
		background-size: 100%;
		background-position: center;
		background-repeat: no-repeat;
	}

	@media screen and (max-width: 500px) {
		#city {
			background-position: bottom center;
		}
	}
</style>
